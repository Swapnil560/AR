import"../chunks/DsnmJJEf.js";import{i as de}from"../chunks/CqFuAgG6.js";import{o as me}from"../chunks/CE2YfgCx.js";import{p as pe,f as p,_ as he,a0 as P,a as m,b as ge,a1 as fe,a2 as r,s as d,m as k,a3 as ue,g as e,a4 as n,a5 as we,a6 as i,$ as j,Z as ke}from"../chunks/ff_rkm8t.js";import{e as x}from"../chunks/Cwbhm3pK.js";import{i as b}from"../chunks/CNscv0VA.js";import{s as A}from"../chunks/DVKhVmrb.js";import{b as J}from"../chunks/CtliRwTt.js";var be=p('<meta name="viewport" content="width=device-width, initial-scale=1.0" class="svelte-mk60tq"/>'),qe=p('<img width="640" height="480" class="ar-filter svelte-mk60tq" alt="AR Filter"/>'),_e=p('<button class="capture-btn video-btn svelte-mk60tq"><span class="capture-icon svelte-mk60tq">ğŸ¥</span> <span class="capture-text svelte-mk60tq">Record</span></button>'),Re=p('<button class="capture-btn stop-btn svelte-mk60tq"><span class="capture-icon svelte-mk60tq">â¹ï¸</span> <span class="capture-text svelte-mk60tq">Stop</span></button>'),ye=p('<div class="recording-indicator svelte-mk60tq"><span class="recording-dot svelte-mk60tq"></span> <span class="recording-text svelte-mk60tq">Recording...</span></div>'),Ce=p('<h2 class="preview-title svelte-mk60tq">ğŸ“· Your AR Photo</h2> <div class="preview-image-container svelte-mk60tq"><img class="preview-image svelte-mk60tq" alt="Captured photo"/></div> <div class="preview-actions svelte-mk60tq"><a download="rongcam-photo.png" class="download-btn svelte-mk60tq"><span class="download-icon svelte-mk60tq">ğŸ’¾</span> Download</a> <button class="share-btn svelte-mk60tq"><span class="share-icon svelte-mk60tq">ğŸ“¤</span> Share</button></div>',1),xe=p('<h2 class="preview-title svelte-mk60tq">ğŸ¥ Your AR Video</h2> <div class="preview-video-container svelte-mk60tq"><video class="preview-video svelte-mk60tq" controls alt="Recorded video"></video></div> <div class="preview-actions svelte-mk60tq"><a download="rongcam-video.webm" class="download-btn svelte-mk60tq"><span class="download-icon svelte-mk60tq">ğŸ’¾</span> Download</a> <button class="share-btn svelte-mk60tq"><span class="share-icon svelte-mk60tq">ğŸ“¤</span> Share</button></div>',3),Ae=p('<div class="preview-section svelte-mk60tq"><div class="preview-container svelte-mk60tq"><!></div></div>'),Se=p('<div class="app-container svelte-mk60tq"><header class="header svelte-mk60tq"><div class="header-content svelte-mk60tq"><h1 class="logo svelte-mk60tq"><span class="logo-icon svelte-mk60tq">ğŸ“·</span> RongCam AR</h1> <p class="tagline svelte-mk60tq">Professional AR Photography</p></div></header> <main class="main-content svelte-mk60tq"><div class="camera-section svelte-mk60tq"><div class="camera-container svelte-mk60tq"><div class="camera-frame svelte-mk60tq"><video width="640" height="480" autoplay class="video-feed svelte-mk60tq"></video> <!> <canvas width="640" height="480" class="capture-canvas svelte-mk60tq"></canvas> <div class="camera-overlay svelte-mk60tq"><div class="corner-frame top-left svelte-mk60tq"></div> <div class="corner-frame top-right svelte-mk60tq"></div> <div class="corner-frame bottom-left svelte-mk60tq"></div> <div class="corner-frame bottom-right svelte-mk60tq"></div></div></div> <div class="controls svelte-mk60tq"><div class="control-buttons svelte-mk60tq"><button class="capture-btn photo-btn svelte-mk60tq"><span class="capture-icon svelte-mk60tq">ğŸ“¸</span> <span class="capture-text svelte-mk60tq">Photo</span></button> <!></div> <!></div></div></div> <!></main></div>',2);function Le(K,N){pe(N,!1);let h=k(),q=k(),g=k(null),l=k(null),c=k(null),u=null,f=k(!1),E=[];me(async()=>{d(g,localStorage.getItem("rongcam_demo_filter")),await Q()});async function Q(){const t=await navigator.mediaDevices.getUserMedia({video:!0});ue(h,e(h).srcObject=t),await e(h).play()}function W(){const t=e(q).getContext("2d");if(t.drawImage(e(h),0,0,640,480),e(g)){const a=new window.Image;a.src=e(g),a.onload=()=>{t.drawImage(a,0,0,640,480),d(l,e(q).toDataURL("image/png")),d(c,null)}}else d(l,e(q).toDataURL("image/png")),d(c,null)}async function X(){try{E=[];const t=e(h).srcObject,a=document.createElement("canvas");a.width=640,a.height=480;const v=a.getContext("2d");let o=null;e(g)&&(o=new Image,o.src=e(g),await new Promise(s=>{o.onload=s,o.onerror=s}));const F=a.captureStream(30),S=()=>{e(f)&&(v.drawImage(e(h),0,0,640,480),o&&o.complete&&v.drawImage(o,0,0,640,480),requestAnimationFrame(S))};u=new MediaRecorder(F,{mimeType:"video/webm"}),u.ondataavailable=s=>{s.data.size>0&&E.push(s.data)},u.onstop=()=>{const s=new Blob(E,{type:"video/webm"});d(c,URL.createObjectURL(s)),d(l,null)},d(f,!0),S(),u.start()}catch(t){console.error("Error starting video recording:",t)}}function $(){u&&e(f)&&(d(f,!1),u.stop())}async function M(){try{if(e(l)){const a=await(await fetch(e(l))).blob(),v=new File([a],"rongcam-photo.png",{type:"image/png"});if(navigator.share&&navigator.canShare&&navigator.canShare({files:[v]}))await navigator.share({title:"RongCam AR Photo",text:"Check out my AR photo from RongCam!",files:[v]});else{const o=document.createElement("a");o.href=e(l),o.download="rongcam-photo.png",o.click(),alert("Photo downloaded! You can now share it from your device.")}}else if(e(c)){const a=await(await fetch(e(c))).blob(),v=new File([a],"rongcam-video.webm",{type:"video/webm"});if(navigator.share&&navigator.canShare&&navigator.canShare({files:[v]}))await navigator.share({title:"RongCam AR Video",text:"Check out my AR video from RongCam!",files:[v]});else{const o=document.createElement("a");o.href=e(c),o.download="rongcam-video.webm",o.click(),alert("Video downloaded! You can now share it from your device.")}}}catch(t){console.error("Error sharing:",t);try{if(e(l)){const a=document.createElement("a");a.href=e(l),a.download="rongcam-photo.png",a.click(),alert("Photo downloaded! You can now share it from your device.")}else if(e(c)){const a=document.createElement("a");a.href=e(c),a.download="rongcam-video.webm",a.click(),alert("Video downloaded! You can now share it from your device.")}}catch{alert("Sharing and download not supported on this device")}}}de();var I=Se();he(t=>{var a=be();fe.title="RongCam AR - Professional AR Camera Experience",m(t,a)});var O=n(r(I),2),V=r(O),z=r(V),U=r(z),B=r(U);J(B,t=>d(h,t),()=>e(h));var T=n(B,2);{var ee=t=>{var a=qe();P(()=>A(a,"src",e(g))),m(t,a)};b(T,t=>{e(g)&&t(ee)})}var ae=n(T,2);J(ae,t=>d(q,t),()=>e(q)),we(2),i(U);var Z=n(U,2),Y=r(Z),D=r(Y),te=n(D,2);{var oe=t=>{var a=_e();x("click",a,X),m(t,a)},se=t=>{var a=Re();x("click",a,$),m(t,a)};b(te,t=>{e(f)?t(se,!1):t(oe)})}i(Y);var re=n(Y,2);{var ne=t=>{var a=ye();m(t,a)};b(re,t=>{e(f)&&t(ne)})}i(Z),i(z),i(V);var ie=n(V,2);{var le=t=>{var a=Ae(),v=r(a),o=r(v);{var F=s=>{var _=Ce(),R=n(j(_),2),L=r(R);i(R);var w=n(R,2),y=r(w),C=n(y,2);i(w),P(()=>{A(L,"src",e(l)),A(y,"href",e(l))}),x("click",C,M),m(s,_)},S=s=>{var _=ke(),R=j(_);{var L=w=>{var y=xe(),C=n(j(y),2),ce=r(C);i(C);var G=n(C,2),H=r(G),ve=n(H,2);i(G),P(()=>{A(ce,"src",e(c)),A(H,"href",e(c))}),x("click",ve,M),m(w,y)};b(R,w=>{e(c)&&w(L)},!0)}m(s,_)};b(o,s=>{e(l)?s(F):s(S,!1)})}i(v),i(a),m(t,a)};b(ie,t=>{(e(l)||e(c))&&t(le)})}i(O),i(I),P(()=>D.disabled=e(f)),x("click",D,W),m(K,I),ge()}export{Le as component};
